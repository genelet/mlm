openapi: 3.0.3
info:
  title: MLM API
  description: |
    Multi-Level Marketing (MLM) REST API built on the Genelet framework.
    All endpoints follow the pattern: `/cgi-bin/goto/{ROLE}/json/{COMPONENT}?action={ACTION}&{OTHER}`
  version: 1.0.0
servers:
  - url: /cgi-bin/goto
paths:
  # ==========================================
  # ROLE: Public (p)
  # ==========================================
  /p/json/member:
    get:
      tags: [Public, Member]
      summary: Member Public Actions
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [startnew, activate, retrieve_pass]
        - name: slogin
          in: query
          description: Sponsor login for startnew
          schema:
            type: string
        - name: login
          in: query
          description: Login for activate
          schema:
            type: string
        - name: secret
          in: query
          description: Secret for activate
          schema:
            type: string
      responses:
        '200':
          description: OK

  /p/json/signup:
    post:
      tags: [Public, Signup]
      summary: Public Signup
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [insert]
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              required: [sidlogin, email, firstname, lastname, login, packageid]
              properties:
                sidlogin: {type: string}
                email: {type: string}
                firstname: {type: string}
                lastname: {type: string}
                login: {type: string}
                passwd: {type: string}
                packageid: {type: integer}
                street: {type: string}
                city: {type: string}
                state: {type: string}
                zip: {type: string}
                country: {type: string}
      responses:
        '200':
          description: OK

  # ==========================================
  # ROLE: Member (m)
  # ==========================================
  /m/json/member:
    get:
      tags: [Member]
      summary: Member Actions (GET)
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [startnew, startdef, changepass, dashboard, edit]
      responses:
        '200':
          description: OK
    post:
      tags: [Member]
      summary: Member Actions (POST)
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [update, changedef]
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
      responses:
        '200':
          description: OK

  /m/json/basket:
    get:
      tags: [Member, Shopping]
      summary: Basket Topics
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [topics]
      responses:
        '200':
          description: OK
    post:
      tags: [Member, Shopping]
      summary: Basket Modifications
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [insert, update, delete]
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                basketid: {type: integer}
                classify: {type: string}
                id: {type: integer}
                qty: {type: integer}
      responses:
        '200':
          description: OK

  /m/json/category:
    get:
      tags: [Member, Products]
      summary: Member Category Topics
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [topics]
      responses:
        '200':
          description: OK

  /m/json/gallery:
    get:
      tags: [Member, Products]
      summary: Member Gallery Topics
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [topics, edit]
      responses:
        '200':
          description: OK

  /m/json/income:
    get:
      tags: [Member, Income]
      summary: Member Income Topics
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [topics]
      responses:
        '200':
          description: OK

  /m/json/ledger:
    get:
      tags: [Member, Ledger]
      summary: Member Ledger Topics
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [topics, edit]
      responses:
        '200':
          description: OK

  /m/json/placement:
    get:
      tags: [Member, Placement]
      summary: Member Placement Actions
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [topics, view_binary]
      responses:
        '200':
          description: OK

  /m/json/sale:
    get:
      tags: [Member, Sales]
      summary: Member Sale Actions
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [topics, startnew, buy, edit, myInvoice]
      responses:
        '200':
          description: OK

  /m/json/sponsor:
    get:
      tags: [Member, Sponsor]
      summary: Member Sponsor Actions
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [topics, view_sponsor]
      responses:
        '200':
          description: OK

  /m/json/tt:
    get:
      tags: [Member, Tickets]
      summary: Member Ticket Actions (GET)
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [startnew, topics, reply, edit]
      responses:
        '200':
          description: OK
    post:
      tags: [Member, Tickets]
      summary: Member Ticket Actions (POST)
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [insert, update]
      responses:
        '200':
          description: OK

  # ==========================================
  # ROLE: Admin (a)
  # ==========================================
  /a/json/admin:
    get:
      tags: [Admin]
      summary: Admin List
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [topics]
      responses:
        '200':
          description: OK
    post:
      tags: [Admin]
      summary: Admin Modifications
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [insert, delete]
      responses:
        '200':
          description: OK

  /a/json/member:
    get:
      tags: [Admin, Member]
      summary: Admin Member Management (GET)
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [topics, bulk, enter, edit]
        - name: u
          in: query
          description: Search field
          schema: {type: string}
        - name: v
          in: query
          description: Search value
          schema: {type: string}
      responses:
        '200':
          description: OK
    post:
      tags: [Admin, Member]
      summary: Admin Member Management (POST)
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [insert, update, delete, resetpass]
      responses:
        '200':
          description: OK

  /a/json/signup:
    get:
      tags: [Admin, Signup]
      summary: Admin Signup Topics
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [topics, bulk]
      responses:
        '200':
          description: OK
    post:
      tags: [Admin, Signup]
      summary: Admin Signup Modifications
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [delete, update]
      responses:
        '200':
          description: OK

  /a/json/income:
    get:
      tags: [Admin, Income]
      summary: Admin Income Operations
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [topics, starttest, week4_direct, week1_binary, week1_match, week1_affiliate, run_to_yesterday, run_daily, run_all_tests]
      responses:
        '200':
          description: OK

  /a/json/ledger:
    get:
      tags: [Admin, Ledger]
      summary: Admin Ledger Topics
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [topics]
      responses:
        '200':
          description: OK
    post:
      tags: [Admin, Ledger]
      summary: Admin Ledger Modifications
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [makeIncome, addShopping, insert, delete, update]
      responses:
        '200':
          description: OK

  /a/json/sale:
    get:
      tags: [Admin, Sales]
      summary: Admin Sale Topics
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [topics]
      responses:
        '200':
          description: OK
    post:
      tags: [Admin, Sales]
      summary: Admin Sale Modifications
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [insert, update]
      responses:
        '200':
          description: OK

  /a/json/placement:
    get:
      tags: [Admin, Placement]
      summary: Admin Placement Operations
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [startnew, topics, leave_tree, join_tree]
      responses:
        '200':
          description: OK

  /a/json/category:
    get:
      tags: [Admin, Products]
      summary: Admin Category Topics
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [topics]
      responses:
        '200':
          description: OK
    post:
      tags: [Admin, Products]
      summary: Admin Category Modifications
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [insert, delete, update]
      responses:
        '200':
          description: OK

  /a/json/gallery:
    get:
      tags: [Admin, Products]
      summary: Admin Gallery Topics
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [topics]
      responses:
        '200':
          description: OK
    post:
      tags: [Admin, Products]
      summary: Admin Gallery Modifications
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [insert, delete, update]
      responses:
        '200':
          description: OK

  /a/json/package:
    get:
      tags: [Admin, Products]
      summary: Admin Package Topics
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [topics, edit]
      responses:
        '200':
          description: OK
    post:
      tags: [Admin, Products]
      summary: Admin Package Modifications
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [insert, delete, update]
      responses:
        '200':
          description: OK

  /a/json/week1:
    get:
      tags: [Admin, Income]
      summary: Weekly Cron Topics
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [topics]
      responses:
        '200':
          description: OK

  /a/json/week4:
    get:
      tags: [Admin, Income]
      summary: Monthly Cron Topics
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [topics]
      responses:
        '200':
          description: OK

  /a/json/affiliate:
    get:
      tags: [Admin]
      summary: Affiliate Topics
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [topics]
      responses:
        '200':
          description: OK
    post:
      tags: [Admin]
      summary: Affiliate Modifications
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [insert, delete]
      responses:
        '200':
          description: OK

  /a/json/incomeamount:
    get:
      tags: [Admin, Income]
      summary: Income Amount Topics
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [topics]
      responses:
        '200':
          description: OK

  /a/json/packagedetail:
    get:
      tags: [Admin, Products]
      summary: Package Detail Topics
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [topics]
      responses:
        '200':
          description: OK
    post:
      tags: [Admin, Products]
      summary: Package Detail Modifications
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [insert, update, delete]
      responses:
        '200':
          description: OK

  /a/json/sponsor:
    get:
      tags: [Admin, Sponsor]
      summary: Admin Sponsor Actions
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [topics, view_sponsor, startnew]
      responses:
        '200':
          description: OK

  /a/json/tt:
    get:
      tags: [Admin, Tickets]
      summary: Admin Ticket Actions (GET)
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [topics, edit, reply]
      responses:
        '200':
          description: OK
    post:
      tags: [Admin, Tickets]
      summary: Admin Ticket Modifications (POST)
      parameters:
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [delete]
      responses:
        '200':
          description: OK
